

<div id="map" class="map-responsive row"></div>


<script>
    function initMap() {

                var currentUserLongitude = 0;
                var currentUserLatitude = 0;
                if (navigator.geolocation) {

                    navigator.geolocation.getCurrentPosition(function(position) {
                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        currentUserLongitude = position.coords.longitude;
                        currentUserLatitude = position.coords.latitude;
                    }, function() {
                        handleLocationError(true, infoWindow, map.getCenter());

                    });
                } else {}
               // var myMapCenter = {lat: currentUserLatitude, lng: currentUserLongitude};
               var myMapCenter = {lat: 48.82785, lng: 1.97684};


                // Create a map object and specify the DOM element for display.
                var map = new google.maps.Map(document.getElementById('map'), {
                    center: myMapCenter,
                    zoom: 13
                });





        function markStore(storeInfo){

            // Create a marker and set its position.
            var marker = new google.maps.Marker({
                map: map,
                position: storeInfo.location,
                title: storeInfo.name,
                link: 'http://127.0.0.1:8000/store/Yvelines'
            });

            // show store info when marker is clicked
            marker.addListener('click', function(){

                showStoreInfo(storeInfo);
            });
        }

        // show store info in text box
        function showStoreInfo(storeInfo){
            var info_div = document.getElementById('info_div');
            info_div.innerHTML = 'Store name: '
                + storeInfo.name
                + '<br>Hours: ' + storeInfo.hours;
        }
        function distance(lat1, lon1, lat2, lon2, unit) {
            var radlat1 = Math.PI * lat1/180
            var radlat2 = Math.PI * lat2/180
            var theta = lon1-lon2
            var radtheta = Math.PI * theta/180
            var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
            if (dist > 1) {
                dist = 1;
            }
            dist = Math.acos(dist)
            dist = dist * 180/Math.PI
            dist = dist * 60 * 1.1515
            if (unit=="K") { dist = dist * 1.609344 }
            if (unit=="N") { dist = dist * 0.8684 }
            return dist
        }

        var stores = [
            {
                name: 'Store 1',
                location: {lat: 48.82785, lng: 1.97684},
                hours: '8AM to 10PM',
                adress: ''
            },
            {
                name: 'Store 2',
                location: {lat:  48.8167, lng: 1.9833},
                hours: '9AM to 9PM',
                adress: 'les clayes sous bois'

            }
            ,
            {
                name: 'Store 3',
                location: {lat:  48.8167, lng: 1.95},
                hours: '9AM to 9PM',
                adress: 'Plaisir - Grignon'
            }
            ,
            {
                name: 'Store 4',
                location: {lat:  48.9, lng: 2.25},
                hours: '9AM to 9PM',
                adress: 'la garenne colombes'
            }

        ];


        stores.forEach(function(store){

            var a = distance(48.82785, 1.97684, store.location.lat, store.location.lng, "K");
            if (distance(48.82785, 1.97684, store.location.lat, store.location.lng, "K") <= 5) {
               markStore(store);
            }
        });


        }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDc7L5LRUHlhEVJpaNSj_bdv-NmVXQJg8A&callback=initMap" async defer></script>


